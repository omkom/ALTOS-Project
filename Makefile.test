# ğŸ§ª Makefile.test - Validation ComplÃ¨te ALTOS-Project
# Auteur : ErlÃ© & ALT
# But : VÃ©rifications et tests automatiques de la structure et de l'intÃ©gritÃ©

.PHONY: test test-status test-vault test-integrity test-structure

# VÃ©rifie la structure logique et sÃ©curitaire du projet
test: test-status test-vault test-integrity test-structure
	@echo "âœ… Tous les tests de validation ALTOS-Project sont PASSÃ‰S avec succÃ¨s."

# Test de script status gÃ©nÃ©ral
test-status:
	@echo "ğŸ” Test [1/4] : VÃ©rification globale de la structure ALTOS..."
	@bash ./status-altos.sh || (echo 'âŒ Ã‰chec de status-altos.sh' && exit 1)

# VÃ©rifie que le coffre sÃ©curisÃ© existe
test-vault:
	@echo "ğŸ” Test [2/4] : VÃ©rification du dossier sÃ©curisÃ© .secure/..."
	@if [ -d ".secure" ]; then echo "âœ… .secure/ est prÃ©sent."; else echo "âŒ Dossier .secure/ manquant."; exit 1; fi

# VÃ©rifie l'intÃ©gritÃ© SHA256 des fichiers critiques
test-integrity:
	@echo "ğŸ” Test [3/4] : VÃ©rification d'intÃ©gritÃ© SHA256 des fichiers critiques..."
	@bash scripts/verify_checksums.sh || (echo 'âŒ Ã‰chec de vÃ©rification des checksums' && exit 1)

# VÃ©rifie que l'arborescence obligatoire existe
test-structure:
	@echo "ğŸ” Test [4/4] : VÃ©rification de la structure obligatoire..."
	@for dir in agent docs foundation evolution archives notes scripts boot_logs voice; do \
		if [ ! -d "$$dir" ]; then echo "âŒ Dossier manquant : $$dir"; exit 1; fi; \
	done
	@echo "âœ… Tous les dossiers critiques sont prÃ©sents."


